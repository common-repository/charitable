"use strict";var CharitableOnboarding=window.CharitableOnboarding||function(t,e,$){var o={init:function(){$(o.ready),$(e).on("load",(function(){"function"==typeof $.ready.then?$.ready.then(o.load):o.load()}))},ready:function(){o.setup(),o.events()},load:function(){},setup:function(){"undefined"!=typeof charitable_admin_builder_onboarding&&void 0!==charitable_admin_builder_onboarding.option&&void 0!==charitable_admin_builder_onboarding.option.status&&("init"===charitable_admin_builder_onboarding.option.status?(o.clearLocalStorage(),o.showWelcomePopup()):"started"===charitable_admin_builder_onboarding.option.status&&o.loadStep()>=1&&(o.clearLocalStorage(),o.stepCompleted(1),o.eventSelectTemplate(),o.updateTooltipUI()))},events:function(){$("#charitable-onboarding-welcome-builder-popup").on("click","button",(function(){o.startOnboarding()})),$(".charitable-onboarding-step1-done").on("click",(function(){o.stepCompleted(1)})),$("#charitable-builder").on("charitableBuilderSetupReady",(function(){o.eventSelectTemplate()})).on("charitablePanelSwitch charitablePanelSectionSwitch",(function(){o.updateTooltipUI()})),$(".charitable-onboarding-step3-done").on("click",(function(){o.stepCompleted(3)})),$(".charitable-onboarding-step4-done").on("click",(function(){o.stepCompleted(4),o.gotoDraftPublishStep()})),$(".charitable-onboarding-step5-done").on("click",(function(){o.undoDraftPublishStep(),o.stepCompleted(5)})),$(".charitable-onboarding-step6-done").on("click",(function(){o.stepCompleted(6)})),$(".charitable-onboarding-step7-done").on("click",(function(){o.stepCompleted(7),o.gotoSettingsStep()})),$(".charitable-onboarding-step8-done").on("click",(function(){o.stepCompleted(8),CharitableCampaignBuilder.panelSwitch("design"),o.showClosingRemarksPopup()})),4==o.loadStep()&&o.gotoDraftPublishStep(),7==o.loadStep()&&o.gotoSettingsStep(),$(t).on("click",".charitable-onboarding-step16-done",o.showEmbedPopup),$.tooltipster.on("ready",o.tooltipsterReady),$(t).on("charitableCampaignFormScreen",(function(){o.stepCompleted(1),o.stepCompleted(2)})),$("#charitable-onboarding-goodbye-builder-popup .charitable-onboarding-popup-btn").on("click",(function(){o.saveOnboardingOption({status:"completed"}),$("#charitable-onboarding-goodbye-builder-popup").fadeOut(),$(".charitable-onboarding-popup-container").fadeOut()}))},eventSelectTemplate:function(){$("#charitable-panel-setup").off("click",".charitable-template-select").on("click",".charitable-template-select",(function(t){o.builderTemplateSelect(this,t)}))},startOnboarding:function(){o.saveOnboardingOption({status:"started"}),$(".charitable-onboarding-popup-container").fadeOut((function(){$("#charitable-onboarding-welcome-builder-popup").hide()})),o.updateTooltipUI()},gotoStep:function(t){console.warn('WARNING! Function "CharitableOnboarding.builder.gotoStep()" has been deprecated.')},builderTemplateSelect:function(t,e){o.resumeOnboardingAndExec(e,(function(){o.stepCompleted(2).done(Charitable.Admin.Builder.Setup.selectTemplate.bind(t,e))}))},tooltipsterReady:function(t){var e=$(t.origin).data("charitable-onboarding-step"),n=$("#charitable-builder-form").data("id");e=parseInt(e,10)||0,n=parseInt(n,10)||0,3===e&&n>0&&o.saveOnboardingOption({form_id:n})},showWelcomePopup:function(){$(".charitable-onboarding-popup-container").fadeIn((function(){$("#charitable-onboarding-welcome-builder-popup").fadeIn()}))},showClosingRemarksPopup:function(){$(".charitable-onboarding-popup-container").fadeIn((function(){$("#charitable-onboarding-goodbye-builder-popup").fadeIn()}))},gotoNotificationStep:function(t){},gotoDraftPublishStep:function(t){o.stepCompleted(4).done((function(){var t=$("#charitable-status-button");t.parent().find("ul#charitable-status-dropdown").removeClass("charitable-hidden"),t.addClass("active"),o.updateTooltipUI()}))},undoDraftPublishStep:function(t){var e=$("#charitable-status-button");e.parent().find("ul#charitable-status-dropdown").addClass("charitable-hidden"),e.removeClass("active"),o.updateTooltipUI()},gotoSettingsStep:function(t){CharitableCampaignBuilder.panelSwitch("settings"),o.updateTooltipUI()},showEmbedPopup:function(){},enableEmbed:function(){$("#charitable-embed").removeClass("charitable-disabled")},saveOnboardingOption:function(t){if("undefined"!=typeof charitable_admin_builder_onboarding){var e={action:"charitable_onboarding_save_option",option_data:t,_wpnonce:charitable_admin_builder_onboarding.nonce};return void 0!==charitable_admin_builder_onboarding.option.window_closed?e.option_data.window_closed=charitable_admin_builder_onboarding.option.window_closed:e.option_data.window_closed=!1,$.extend(charitable_admin_builder_onboarding.option,t),$.post(charitable_builder.ajax_url,e,(function(t){t.success||console.error("Error saving Chartiable Onboarding option.")}))}},refreshStep:function(){var t=el.$onboarding.data("charitable-onboarding-saved-step");t=parseInt(t,10)||0,o.loadStep()!==t&&o.saveStep(t)},stepCompleted:function(t){return o.updateTooltipUI(t),o.saveStep(t)},initTooltips:function(t,e,o){if(void 0!==$.fn.tooltipster){var n=$('<span class="charitable-onboarding-dot charitable-onboarding-dot-step'+t+'" data-charitable-onboarding-step="'+t+'">&nbsp;</span>'),a={content:$("#tooltip-content"+t),trigger:null,interactive:!0,animationDuration:0,delay:0,theme:["tooltipster-default","charitable-onboarding-tooltip"],side:["top"],distance:3,functionReady:function(e,o){$(o.tooltip).addClass("charitable-onboarding-tooltip-step"+t),3===t||4===t||6===t||7===t||8===t?e.option("side","bottom"):5===t?e.option("side","left"):1===t&&e.option("side","bottom"),e.reposition()}};"object"==typeof o&&null!==o&&$.extend(a,o),5===t?n.insertBefore(e).tooltipster(a):n.insertAfter(e).tooltipster(a)}},updateTooltipUI:function(t){var e;t=t||o.loadStep(),e=t+1,$(".charitable-onboarding-dot").each((function(t,o){var n=$(o),a=n.data("charitable-onboarding-step");a<e&&n.addClass("charitable-onboarding-dot-completed"),a>e&&n.addClass("charitable-onboarding-dot-next"),a===e&&n.removeClass("charitable-onboarding-dot-completed charitable-onboarding-dot-next"),setTimeout((function(){n.is(":visible")&&a===e?n.tooltipster("open"):n.tooltipster("close")}),0)}))},loadStep:function(){var t=localStorage.getItem("charitableOnboardingStep");return t=parseInt(t,10)||0},saveStep:function(t){return localStorage.setItem("charitableOnboardingStep",t),o.saveOnboardingOption({step:t})},clearLocalStorage:function(){localStorage.removeItem("charitableOnboardingStep")}};return o}(document,window,jQuery);CharitableOnboarding.init();