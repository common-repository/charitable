"use strict";var CharitableOnboarding=window.CharitableOnboarding||function(t,o,$){var e={init:function(){$(e.ready),$(o).on("load",(function(){"function"==typeof $.ready.then?$.ready.then(e.load):e.load()}))},ready:function(){},load:function(){},setup:function(){"undefined"!=typeof charitable_admin_builder_onboarding&&void 0!==charitable_admin_builder_onboarding.option&&void 0!==charitable_admin_builder_onboarding.option.status&&("init"===charitable_admin_builder_onboarding.option.status?(e.clearLocalStorage(),e.showWelcomePopup()):"started"===charitable_admin_builder_onboarding.option.status&&e.loadStep()>=1&&(e.clearLocalStorage(),e.stepCompleted(1),e.eventSelectTemplate(),e.updateTooltipUI()))},events:function(){$("#charitable-onboarding-welcome-builder-popup").on("click","button",(function(){e.startOnboarding()})),$(".charitable-onboarding-step1-done").on("click",(function(){e.stepCompleted(1)})),$("#charitable-builder").on("charitableBuilderSetupReady",(function(){e.eventSelectTemplate()})).on("charitablePanelSwitch charitablePanelSectionSwitch",(function(){e.updateTooltipUI()})),$(".charitable-onboarding-step3-done").on("click",(function(){e.stepCompleted(3)})),$(".charitable-onboarding-step4-done").on("click",(function(){e.stepCompleted(4),e.gotoDraftPublishStep()})),$(".charitable-onboarding-step5-done").on("click",(function(){e.undoDraftPublishStep(),e.stepCompleted(5)})),$(".charitable-onboarding-step6-done").on("click",(function(){e.stepCompleted(6)})),$(".charitable-onboarding-step7-done").on("click",(function(){e.stepCompleted(7),e.gotoSettingsStep()})),$(".charitable-onboarding-step8-done").on("click",(function(){e.stepCompleted(8),CharitableCampaignBuilder.panelSwitch("design"),e.showClosingRemarksPopup()})),4==e.loadStep()&&e.gotoDraftPublishStep(),7==e.loadStep()&&e.gotoSettingsStep(),$(t).on("click",".charitable-onboarding-step16-done",e.showEmbedPopup),$.tooltipster.on("ready",e.tooltipsterReady),$(t).on("charitableCampaignFormScreen",(function(){e.stepCompleted(1),e.stepCompleted(2)})),$("#charitable-onboarding-goodbye-builder-popup .charitable-onboarding-popup-btn").on("click",(function(){e.saveOnboardingOption({status:"completed"}),$("#charitable-onboarding-goodbye-builder-popup").fadeOut(),$(".charitable-onboarding-popup-container").fadeOut()}))},eventSelectTemplate:function(){$("#charitable-panel-setup").off("click",".charitable-template-select").on("click",".charitable-template-select",(function(t){e.builderTemplateSelect(this,t)}))},startOnboarding:function(){e.saveOnboardingOption({status:"started"}),$(".charitable-onboarding-popup-container").fadeOut((function(){$("#charitable-onboarding-welcome-builder-popup").hide()})),e.updateTooltipUI()},gotoStep:function(t){console.warn('WARNING! Function "CharitableOnboarding.builder.gotoStep()" has been deprecated.')},builderTemplateSelect:function(t,o){e.resumeOnboardingAndExec(o,(function(){e.stepCompleted(2).done(Charitable.Admin.Builder.Setup.selectTemplate.bind(t,o))}))},tooltipsterReady:function(t){var o=$(t.origin).data("charitable-onboarding-step"),n=$("#charitable-builder-form").data("id");o=parseInt(o,10)||0,n=parseInt(n,10)||0,3===o&&n>0&&e.saveOnboardingOption({form_id:n})},showWelcomePopup:function(){$(".charitable-onboarding-popup-container").fadeIn((function(){$("#charitable-onboarding-welcome-builder-popup").fadeIn()}))},showClosingRemarksPopup:function(){$(".charitable-onboarding-popup-container").fadeIn((function(){$("#charitable-onboarding-goodbye-builder-popup").fadeIn()}))},gotoNotificationStep:function(t){},gotoDraftPublishStep:function(t){e.stepCompleted(4).done((function(){var t=$("#charitable-status-button");t.parent().find("ul#charitable-status-dropdown").removeClass("charitable-hidden"),t.addClass("active"),e.updateTooltipUI()}))},undoDraftPublishStep:function(t){var o=$("#charitable-status-button");o.parent().find("ul#charitable-status-dropdown").addClass("charitable-hidden"),o.removeClass("active"),e.updateTooltipUI()},gotoSettingsStep:function(t){CharitableCampaignBuilder.panelSwitch("settings"),e.updateTooltipUI()},showEmbedPopup:function(){},enableEmbed:function(){$("#charitable-embed").removeClass("charitable-disabled")},saveOnboardingOption:function(t){if("undefined"!=typeof charitable_admin_builder_onboarding){var o={action:"charitable_onboarding_save_option",option_data:t,_wpnonce:charitable_admin_builder_onboarding.nonce};return void 0!==charitable_admin_builder_onboarding.option.window_closed?o.option_data.window_closed=charitable_admin_builder_onboarding.option.window_closed:o.option_data.window_closed=!1,$.extend(charitable_admin_builder_onboarding.option,t),$.post(charitable_builder.ajax_url,o,(function(t){t.success||console.error("Error saving Chartiable Onboarding option.")}))}},refreshStep:function(){var t=el.$onboarding.data("charitable-onboarding-saved-step");t=parseInt(t,10)||0,e.loadStep()!==t&&e.saveStep(t)},stepCompleted:function(t){return e.updateTooltipUI(t),e.saveStep(t)},initTooltips:function(t,o,e){if(void 0!==$.fn.tooltipster){var n=$('<span class="charitable-onboarding-dot charitable-onboarding-dot-step'+t+'" data-charitable-onboarding-step="'+t+'">&nbsp;</span>'),a={content:$("#tooltip-content"+t),trigger:null,interactive:!0,animationDuration:0,delay:0,theme:["tooltipster-default","charitable-onboarding-tooltip"],side:["top"],distance:3,functionReady:function(o,e){$(e.tooltip).addClass("charitable-onboarding-tooltip-step"+t),3===t||4===t||6===t||7===t||8===t?o.option("side","bottom"):5===t?o.option("side","left"):1===t&&o.option("side","bottom"),o.reposition()}};"object"==typeof e&&null!==e&&$.extend(a,e),5===t?n.insertBefore(o).tooltipster(a):n.insertAfter(o).tooltipster(a)}},updateTooltipUI:function(t){var o;t=t||e.loadStep(),o=t+1,$(".charitable-onboarding-dot").each((function(t,e){var n=$(e),a=n.data("charitable-onboarding-step");a<o&&n.addClass("charitable-onboarding-dot-completed"),a>o&&n.addClass("charitable-onboarding-dot-next"),a===o&&n.removeClass("charitable-onboarding-dot-completed charitable-onboarding-dot-next"),setTimeout((function(){n.is(":visible")&&a===o?n.tooltipster("open"):n.tooltipster("close")}),0)}))},loadStep:function(){var t=localStorage.getItem("charitableOnboardingStep");return t=parseInt(t,10)||0},saveStep:function(t){return localStorage.setItem("charitableOnboardingStep",t),e.saveOnboardingOption({step:t})},clearLocalStorage:function(){localStorage.removeItem("charitableOnboardingStep")}};return e}(document,window,jQuery);CharitableOnboarding.init();